# 멀티플레이어 시스템 (Part 1)

## 매치메이킹

### 로비 시스템
- **솔로 큐**: 개인 플레이어를 위한 매치메이킹 시스템
- **파티 큐**: 2-4명으로 구성된 파티를 위한 매치메이킹
- **커스텀 매치**: 사용자 지정 규칙의 비공개 매치 생성 기능

### 서버 선택
- **지역별 서버**: 북미, 유럽, 아시아 등 주요 지역별 서버 제공
- **핑 기반 매치**: 플레이어의 핑을 고려한 최적 서버 자동 배정
- **서버 상태 표시**: 현재 서버 상태 및 지연 시간 정보 제공

### 밸런스 매치메이킹
- **실력 기반**: 플레이어의 실력(MMR)을 고려한 매치 생성
- **클래스 밸런스**: 다양한 클래스의 균형 있는 분배
- **파티 크기 고려**: 솔로 플레이어와 파티 간의 공정한 매치 보장

### 매치 참여 및 준비
- **캐릭터 선택**: 매치 시작 전 캐릭터 및 장비 선택 단계
- **준비 상태**: 모든 플레이어의 준비 상태 확인 시스템
- **매치 정보**: 맵 유형, 난이도, 참여 플레이어 정보 표시

## 네트워크 아키텍처

### MagicOnion 기반 구조
- **Hub 패턴**: 실시간 양방향 통신을 위한 핵심 구조
  - 플레이어 위치 동기화
  - 전투 액션 및 피해 계산 전파
  - 아이템 상호작용 동기화
  - 던전 환경 이벤트 관리
- **Service 패턴**: 요청-응답 기반의 비실시간 통신
  - 인벤토리 및 장비 업데이트
  - 매치메이킹 요청 및 응답
  - 캐릭터 정보 및 통계 저장/조회
  - 서버 상태 확인

### 동기화 시스템
- **위치 동기화**: 플레이어 및 NPC의 위치, 회전, 속도 동기화
  - 예측 알고리즘을 통한 지연 최소화
  - 불일치 감지 및 보정 메커니즘
- **액션 동기화**: 공격, 스킬 사용, 아이템 사용 등의 액션 동기화
  - 타임스탬프 기반 액션 처리
  - 우선순위 및 충돌 해결 로직
- **상태 동기화**: 체력, 마나, 버프/디버프 등 상태 정보 동기화
  - 변경 감지 기반 효율적 업데이트
  - 중요도에 따른 동기화 빈도 조절

### 안티 치트 시스템
- **서버 권한 모델**: 주요 게임 로직 및 검증을 서버에서 처리
  - 클라이언트는 입력만 전송, 결과는 서버에서 계산
  - 민감한 정보(다른 플레이어 위치 등)의 선별적 전송
- **클라이언트 데이터 검증**: 클라이언트 전송 데이터의 유효성 검사
  - 물리적으로 불가능한 이동 감지
  - 비정상적인 액션 빈도 및 패턴 감지
- **암호화 및 무결성 검사**: 통신 데이터 암호화 및 변조 방지
  - 중요 데이터의 암호화 전송
  - 패킷 무결성 검사 및 해시 확인

### 네트워크 최적화
- **대역폭 관리**: 제한된 대역폭에서의 효율적 통신
  - 동적 압축 및 우선순위 기반 전송
  - LOD(Level of Detail) 기반 데이터 전송
- **지연 시간 최소화**: 지연 시간을 최소화하기 위한 기법
  - 클라이언트 측 예측 및 보정
  - 서버 처리 최적화 및 병렬화
- **장애 대응**: 네트워크 불안정성에 대한 대응 방안
  - 재접속 및 상태 복구 메커니즘
  - 세션 유지 및 임시 저장 기능

[계속해서 Part 2로](./MultiplayerSystem_part2.md)

[목차로 돌아가기](./MasterPlan.md)
